# ğŸ“§ Outlooké‚®ä»¶ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºFastAPIå’Œç°ä»£WebæŠ€æœ¯æ„å»ºçš„Outlooké‚®ä»¶ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šè´¦æˆ·ç®¡ç†ã€é‚®ä»¶æŸ¥çœ‹ã€æœç´¢è¿‡æ»¤ç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ  ä¸»è¦åŠŸèƒ½

- **ğŸ“§ é‚®ä»¶ç®¡ç†**: æ”¯æŒæŸ¥çœ‹ã€æœç´¢ã€è¿‡æ»¤é‚®ä»¶
- **ğŸ‘¥ å¤šè´¦æˆ·ç®¡ç†**: æ”¯æŒæ·»åŠ å’Œç®¡ç†å¤šä¸ªOutlooké‚®ç®±è´¦æˆ·
- **ğŸ“¦ æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ·»åŠ é‚®ç®±è´¦æˆ·
- **ğŸ” æ™ºèƒ½æœç´¢**: å®æ—¶æœç´¢é‚®ä»¶æ ‡é¢˜ã€å‘ä»¶äººç­‰ä¿¡æ¯
- **ğŸ“Š æ•°æ®ç»Ÿè®¡**: æ˜¾ç¤ºé‚®ä»¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»æ•°ã€æœªè¯»ã€ä»Šæ—¥é‚®ä»¶ç­‰ï¼‰
- **ğŸ“¤ æ•°æ®å¯¼å‡º**: æ”¯æŒå¯¼å‡ºé‚®ä»¶åˆ—è¡¨ä¸ºCSVæ ¼å¼
- **ğŸš€ é«˜æ€§èƒ½**: è¿æ¥æ± ä¼˜åŒ–ã€æ™ºèƒ½ç¼“å­˜ã€æ‰¹é‡å¤„ç†
- **ğŸ“– APIæ–‡æ¡£**: å®Œæ•´çš„RESTful APIæ¥å£æ–‡æ¡£

### ğŸ¨ ç”¨æˆ·ç•Œé¢

#### é‚®ä»¶åˆ—è¡¨ç•Œé¢
![é‚®ä»¶åˆ—è¡¨](docs/images/email-list.png)
*é‚®ä»¶åˆ—è¡¨é¡µé¢ï¼Œæ”¯æŒæœç´¢ã€è¿‡æ»¤å’Œç»Ÿè®¡åŠŸèƒ½*

#### é‚®ç®±è´¦æˆ·ç®¡ç†
![è´¦æˆ·ç®¡ç†](docs/images/account-management.png)
![è´¦æˆ·æ‰¹é‡ç®¡ç†](docs/images/account-add.png)
*é‚®ç®±è´¦æˆ·ç®¡ç†é¡µé¢ï¼Œæ”¯æŒæ·»åŠ ã€åˆ é™¤å’ŒæŸ¥çœ‹é‚®ç®±çŠ¶æ€*

#### APIæ¥å£æ–‡æ¡£
![APIæ–‡æ¡£](docs/images/api-docs.png)
*å®Œæ•´çš„APIæ¥å£æ–‡æ¡£ï¼Œæ”¯æŒåœ¨çº¿æµ‹è¯•*

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- **ğŸ—ï¸ ç°ä»£æ¶æ„**: FastAPI + HTML5 + CSS3 + JavaScript
- **âš¡ é«˜æ€§èƒ½**: IMAPè¿æ¥æ±  + Graph APIã€æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- **ğŸ¯ ç”¨æˆ·å‹å¥½**: å“åº”å¼è®¾è®¡ã€å®æ—¶é€šçŸ¥ã€é”®ç›˜å¿«æ·é”®
- **ğŸ”’ å®‰å…¨å¯é **: OAuth2è®¤è¯ã€é”™è¯¯å¤„ç†ã€è¿æ¥ç®¡ç†
- **ğŸ“± ç§»åŠ¨é€‚é…**: æ”¯æŒç§»åŠ¨è®¾å¤‡è®¿é—®
- **ğŸŒ RESTful API**: æ ‡å‡†åŒ–APIæ¥å£è®¾è®¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- ç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariã€Edgeï¼‰
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºè®¿é—®Outlook IMAPå’ŒMicrosoft GraphæœåŠ¡ï¼‰

### ğŸ“¦ å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd OutlookManager

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt
```

### âš™ï¸ é…ç½®è®¾ç½®

1. **Azureåº”ç”¨æ³¨å†Œ**ï¼ˆå¿…éœ€ï¼‰
   - è®¿é—® [Azure Portal](https://portal.azure.com)
   - æ³¨å†Œæ–°çš„åº”ç”¨ç¨‹åº
   - é…ç½®é‚®ä»¶è¯»å–æƒé™
   - è·å–Client IDå’ŒRefresh Token

2. **ç¯å¢ƒé…ç½®**ï¼ˆå¯é€‰ï¼‰
   ```bash
   # å¤åˆ¶é…ç½®æ–‡ä»¶
   cp .env.example .env

   # ç¼–è¾‘é…ç½®æ–‡ä»¶
   nano .env
   ```

### ğŸ¯ å¯åŠ¨æœåŠ¡

#### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python main.py

# æˆ–ä½¿ç”¨uvicorn
uvicorn main:app --host 0.0.0.0 --port 8001 --reload
```

#### ç”Ÿäº§ç¯å¢ƒ

```bash
# ä½¿ç”¨gunicornå¯åŠ¨
pip install gunicorn
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8001

# æˆ–ä½¿ç”¨uvicorn
uvicorn main:app --host 0.0.0.0 --port 8001 --workers 4
```

### ğŸŒ è®¿é—®ç³»ç»Ÿ

å¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- **Webç•Œé¢**: http://localhost:8001
- **APIæ–‡æ¡£**: http://localhost:8001/docs
- **APIçŠ¶æ€**: http://localhost:8001/api

## ğŸ“š ä½¿ç”¨æŒ‡å—

### 1ï¸âƒ£ æ·»åŠ é‚®ç®±è´¦æˆ·

1. ç‚¹å‡»å·¦ä¾§èœå•"æ·»åŠ è´¦æˆ·"
2. å¡«å†™é‚®ç®±åœ°å€ã€åˆ·æ–°ä»¤ç‰Œå’Œå®¢æˆ·ç«¯IDï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä½¿ç”¨ IMAP æˆ– Graph æ¨¡å¼ï¼‰
3. ç‚¹å‡»"æµ‹è¯•è¿æ¥"éªŒè¯é…ç½®
4. ç‚¹å‡»"æ·»åŠ è´¦æˆ·"å®Œæˆæ·»åŠ 

### 2ï¸âƒ£ æŸ¥çœ‹é‚®ä»¶

1. åœ¨è´¦æˆ·åˆ—è¡¨ä¸­ç‚¹å‡»"æŸ¥çœ‹é‚®ä»¶"
2. ä½¿ç”¨æœç´¢æ¡†æŸ¥æ‰¾ç‰¹å®šé‚®ä»¶
3. ä½¿ç”¨è¿‡æ»¤å™¨æŒ‰æ¡ä»¶ç­›é€‰
4. ç‚¹å‡»é‚®ä»¶æŸ¥çœ‹è¯¦ç»†å†…å®¹

### 3ï¸âƒ£ æ‰¹é‡æ·»åŠ è´¦æˆ·

1. ç‚¹å‡»å·¦ä¾§èœå•"æ‰¹é‡æ·»åŠ "
2. æŒ‰æ ¼å¼è¾“å…¥è´¦æˆ·ä¿¡æ¯ï¼ˆæ”¯æŒä¸¤ç§é¡ºåºï¼‰ï¼š`é‚®ç®±----å¯†ç ----åˆ·æ–°ä»¤ç‰Œ----å®¢æˆ·ç«¯ID` æˆ– `é‚®ç®±----å¯†ç ----å®¢æˆ·ç«¯ID----åˆ·æ–°ä»¤ç‰Œ`
3. ç‚¹å‡»"éªŒè¯æ ¼å¼"æ£€æŸ¥æ•°æ®
4. ç‚¹å‡»"å¼€å§‹æ‰¹é‡æ·»åŠ "æ‰§è¡Œ

### 4ï¸âƒ£ APIè°ƒç”¨

æŸ¥çœ‹"APIç®¡ç†"é¡µé¢è·å–å®Œæ•´çš„æ¥å£æ–‡æ¡£ï¼Œæ”¯æŒï¼š
- è·å–é‚®ç®±åˆ—è¡¨ï¼š`GET /accounts`
- è·å–é‚®ä»¶åˆ—è¡¨ï¼š`GET /emails/{email_id}`
- è·å–é‚®ä»¶è¯¦æƒ…ï¼š`GET /emails/{email_id}/{message_id}`ï¼ˆIMAP: `{folder}-{id}`ï¼ŒGraph: `GRAPH-{encoded_id}`ï¼‰

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ğŸ³ Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t outlook-manager .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name outlook-manager \
  -p 8001:8001 \
  -v $(pwd)/accounts.json:/app/accounts.json \
  outlook-manager
```

### â˜ï¸ äº‘æœåŠ¡å™¨éƒ¨ç½²

#### 1. å‡†å¤‡æœåŠ¡å™¨
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Pythonå’Œä¾èµ–
sudo apt install python3 python3-pip nginx -y
```

#### 2. éƒ¨ç½²åº”ç”¨
```bash
# ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
scp -r . user@server:/opt/outlook-manager/

# å®‰è£…ä¾èµ–
cd /opt/outlook-manager
pip3 install -r requirements.txt
```

#### 3. é…ç½®Nginx
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### 4. é…ç½®ç³»ç»ŸæœåŠ¡
```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/outlook-manager.service
```

```ini
[Unit]
Description=Outlook Manager
After=network.target

[Service]
Type=exec
User=www-data
WorkingDirectory=/opt/outlook-manager
ExecStart=/usr/bin/python3 -m uvicorn main:app --host 0.0.0.0 --port 8001
Restart=always

[Install]
WantedBy=multi-user.target
```

```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable outlook-manager
sudo systemctl start outlook-manager
```

### ğŸ”§ æ€§èƒ½ä¼˜åŒ–

#### 1. æ•°æ®åº“ä¼˜åŒ–
```bash
# å¦‚æœä½¿ç”¨SQLiteï¼Œå®šæœŸä¼˜åŒ–
sqlite3 accounts.db "VACUUM;"
```

#### 2. ç¼“å­˜é…ç½®
```python
# åœ¨main.pyä¸­è°ƒæ•´ç¼“å­˜è®¾ç½®
CACHE_EXPIRE_TIME = 300  # 5åˆ†é’Ÿ
MAX_CONNECTIONS = 10     # æœ€å¤§è¿æ¥æ•°
```

#### 3. è´Ÿè½½å‡è¡¡
```bash
# ä½¿ç”¨å¤šä¸ªworkerè¿›ç¨‹
gunicorn main:app -w 8 -k uvicorn.workers.UvicornWorker
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ğŸ“ é¡¹ç›®ç»“æ„
```
OutlookManager/
â”œâ”€â”€ main.py              # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ static/
â”‚   â””â”€â”€ index.html       # å‰ç«¯é¡µé¢
â”œâ”€â”€ accounts.json        # è´¦æˆ·æ•°æ®æ–‡ä»¶
â”œâ”€â”€ requirements.txt     # Pythonä¾èµ–
â”œâ”€â”€ README.md           # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ docs/               # æ–‡æ¡£å’Œå›¾ç‰‡
    â””â”€â”€ images/
```

### ğŸ”§ å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements-dev.txt

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
uvicorn main:app --reload --host 0.0.0.0 --port 8001
```

### ğŸ§ª æµ‹è¯•
```bash
# è¿è¡Œæµ‹è¯•
python -m pytest tests/

# ä»£ç è¦†ç›–ç‡
python -m pytest --cov=main tests/
```

## ğŸ“ æ”¯æŒä¸åé¦ˆ

- **é—®é¢˜æŠ¥å‘Š**: è¯·åœ¨GitHub Issuesä¸­æäº¤
- **åŠŸèƒ½å»ºè®®**: æ¬¢è¿æäº¤Pull Request
- **æŠ€æœ¯æ”¯æŒ**: æŸ¥çœ‹APIæ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿ
---

**ğŸ‰ æ„Ÿè°¢ä½¿ç”¨Outlooké‚®ä»¶ç®¡ç†ç³»ç»Ÿï¼**
